{
  "packages":[
    "github.com/wolferton/87rb/87rb-api/endpoint",
    "github.com/wolferton/87rb/87rb-api/dao",
    "github.com/wolferton/87rb/87rb-api/trigger",
    "github.com/wolferton/quilt/ws"
  ],

  "components": {
    "jobDao": {
      "type": "dao.JobDao",
      "Accessor": "ref:quiltDatabaseAccessor"
    },
    "databaseProvider": {
      "type": "dao.PostgreSQLCoreDatabaseProvider",
      "ConnectionString": "conf:database.core.connectionString"
    },

    "postJobProvider": {
      "type": "ws.WsHandler",
      "HttpMethod": "POST",
      "PathMatchPattern": "/job",
      "Logic": "ref:postJobLogic"
    },

    "postJobLogic": {
      "type": "endpoint.PostJobLogic",
      "JobDao": "ref:jobDao",
      "TriggerNotifier": "ref:httpTriggerNotifier"
    },

    "httpTriggerNotifier": {
      "type": "trigger.HttpTriggerNotifier",
      "TriggerUri": "conf:trigger.lifecycleUri"
    },

    "healthCheckProvider": {
      "type": "ws.WsHandler",
      "HttpMethod": "GET",
      "PathMatchPattern": "/health-check",
      "Logic": "ref:healthCheckLogic"
    },

    "healthCheckLogic": {
      "type": "endpoint.GetHealthCheckLogic"
    }
  }
}
